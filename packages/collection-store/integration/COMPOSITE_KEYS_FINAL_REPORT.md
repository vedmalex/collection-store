# –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏ - –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π (composite keys) –≤ collection-store –±–∏–±–ª–∏–æ—Ç–µ–∫—É —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º API, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º –∫–∞–∫ –æ–¥–∏–Ω–æ—á–Ω—ã–µ, —Ç–∞–∫ –∏ —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏ —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º –ø–æ—Ä—è–¥–∫–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏.

## ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
- **CompositeKeyUtils –∫–ª–∞—Å—Å** - –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω ‚úÖ
- **–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ ‚úÖ
- **–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤** - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π ‚úÖ
- **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω –∏–Ω–¥–µ–∫—Å–æ–≤** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å —É—á–µ—Ç–æ–º –ø–æ—Ä—è–¥–∫–∞ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ‚úÖ
- **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –æ–±—Ä–∞–±–æ—Ç–∫–∏** - –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –æ–±—ä–µ–∫—Ç–æ–≤ ‚úÖ
- **–°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä–æ–≤** - –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ ‚úÖ

### 2. –¢–∏–ø—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
```typescript
// –ù–æ–≤—ã–µ —Ç–∏–ø—ã –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
export interface IndexField<T extends Item> {
  key: string | Paths<T>
  order?: 'asc' | 'desc'
}

// –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π IndexDef —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
export interface IndexDef<T extends Item> {
  key?: string | Paths<T>           // –î–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∫–ª—é—á–µ–π
  keys?: Array<string | Paths<T> | IndexField<T>>  // –î–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
  order?: 'asc' | 'desc'           // –ü–æ—Ä—è–¥–æ–∫ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∫–ª—é—á–µ–π
  separator?: string               // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞
}
```

### 3. –ß–∏—Å—Ç—ã–π —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
- **–£–¥–∞–ª–µ–Ω legacy —Ñ–æ—Ä–º–∞—Ç `composite`** - —É–ø—Ä–æ—â–µ–Ω API ‚úÖ
- **–ï–¥–∏–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç** - —Ç–æ–ª—å–∫–æ `key` –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏ `keys` –¥–ª—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π ‚úÖ
- **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞** - —É–±—Ä–∞–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ ‚úÖ

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- **CompositeKeyUtils —Ç–µ—Å—Ç—ã** - 48/48 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ
- **–ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å** - –≤—Å–µ —É—Ç–∏–ª–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ
- **Edge cases** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ null, undefined, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ ‚úÖ

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã, —Ç—Ä–µ–±—É—é—â–∏–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
**–°—Ç–∞—Ç—É—Å**: ‚ùå –ù–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ "value for index id is required, but undefined is met"
**–ü—Ä–∏—á–∏–Ω–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –º–µ–∂–¥—É –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π ID –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –∏–Ω–¥–µ–∫—Å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

**–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã**:
- –ü–µ—Ä–≤—ã–µ 3 —Ç–µ—Å—Ç–∞ (—Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤) –ø—Ä–æ—Ö–æ–¥—è—Ç ‚úÖ
- –í—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–∞–¥–∞—é—Ç —Å –æ—à–∏–±–∫–æ–π ID ‚ùå
- –°–∏—Å—Ç–µ–º–∞ —Ç—Ä–µ–±—É–µ—Ç ID –¥–ª—è –∏–Ω–¥–µ–∫—Å–æ–≤, –Ω–æ –æ–±—ä–µ–∫—Ç—ã —Å–æ–∑–¥–∞—é—Ç—Å—è –±–µ–∑ ID

### 2. –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å ID
1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é —Å —è–≤–Ω—ã–º ID –ø–æ–ª–µ–º**:
   ```typescript
   collection = Collection.create<TestItem>({
     id: 'id',  // –£–∫–∞–∑–∞—Ç—å –ø–æ–ª–µ ID
     // ...
   })
   ```

2. **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å ID –≤ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**:
   ```typescript
   const testItems = [
     { id: 1, category: 'bug', ... },
     { id: 2, category: 'feature', ... }
   ]
   ```

3. **–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ID** –≤ collection.ts

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã/–∏–∑–º–µ–Ω–µ–Ω—ã:
- ‚úÖ `src/types/IndexDef.ts` - –†–∞—Å—à–∏—Ä–µ–Ω—ã —Ç–∏–ø—ã
- ‚úÖ `src/utils/CompositeKeyUtils.ts` - –ù–æ–≤—ã–π –∫–ª–∞—Å—Å —É—Ç–∏–ª–∏—Ç
- ‚úÖ `src/collection.ts` - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–¥–µ–∫—Å–æ–≤
- ‚úÖ `src/collection/create_index.ts` - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
- ‚úÖ `src/collection/ensure_indexed_value.ts` - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞
- ‚úÖ `src/collection/get_value.ts` - –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞

### –¢–µ—Å—Ç—ã:
- ‚úÖ `src/__test__/CompositeKeyUtils.unified.test.ts` - 48/48 ‚úÖ
- ‚úÖ `src/__test__/composite-index-basic.test.ts` - 20/20 ‚úÖ
- ‚ùå `src/__test__/composite-index-integration.test.ts` - 3/20 ‚úÖ (17 –ø–∞–¥–∞—é—Ç –∏–∑-–∑–∞ ID)

## üîß –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

### 1. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
```typescript
// –û–¥–∏–Ω–æ—á–Ω—ã–π –∫–ª—é—á
{ key: 'price', order: 'desc' }

// –°–æ—Å—Ç–∞–≤–Ω–æ–π –∫–ª—é—á (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
{ keys: ['category', 'price'] }
{ keys: [
  'category',
  { key: 'price', order: 'desc' },
  'rating'
]}

// –° –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–µ–º
{ keys: ['category', 'price'], separator: '|' }
```

### 2. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `\u0000` (null character)
- **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã —ç–∫—Ä–∞–Ω–∏—Ä—É—é—Ç—Å—è
- **–¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö**: –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ —Å—Ç—Ä–æ–∫–∞–º
- **Null/undefined**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–º–µ–Ω –∏–Ω–¥–µ–∫—Å–æ–≤
```typescript
// –û–¥–∏–Ω–æ—á–Ω—ã–π –∫–ª—é—á
'price' -> 'price'

// –°–æ—Å—Ç–∞–≤–Ω–æ–π –∫–ª—é—á
['category', 'price'] -> 'category,price'

// –° –ø–æ—Ä—è–¥–∫–æ–º —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
[{key: 'category', order: 'asc'}, {key: 'price', order: 'desc'}]
-> 'category,price:desc'
```

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
1. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å ID –≤ collection.ts
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ID —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Å–æ—Å—Ç–∞–≤–Ω—ã–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –¢–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. –¢–µ—Å—Ç—ã —Å –±–æ–ª—å—à–∏–º–∏ –æ–±—ä–µ–º–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
3. –¢–µ—Å—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–Ω–¥–µ–∫—Å–∞–º–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
1. –û–±–Ω–æ–≤–∏—Ç—å README —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
2. –°–æ–∑–¥–∞—Ç—å migration guide –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –Ω–æ–≤—ã–π API
3. –î–æ–±–∞–≤–∏—Ç—å JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

## üí° –í—ã–≤–æ–¥—ã

**–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∫–ª—é—á–µ–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**. –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è —Å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–º –≤ —Å–∏—Å—Ç–µ–º–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è ID.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è**:
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π API
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞**:
- ‚úÖ –¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ (—É—Ç–∏–ª–∏—Ç—ã)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã —Å ID –≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö.

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω: $(date)*
*–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: 48/48 (—Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∫–ª—é—á–∏) + 639/731 (–æ–±—â–∏–µ)*
*–ü–æ–∫—Ä—ã—Ç–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: 85%*