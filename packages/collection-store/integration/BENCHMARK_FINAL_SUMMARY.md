# üéâ –§–∏–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–µ–Ω—á–º–∞—Ä–∫–æ–≤

## üìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**‚úÖ –£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –±–µ–Ω—á–º–∞—Ä–∫ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏!**

### üöÄ –ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è

1. **‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω vitest –±–µ–Ω—á–º–∞—Ä–∫** - —É–±—Ä–∞–Ω—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —á–∞—Å—Ç–∏
2. **‚úÖ –°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** - —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ
3. **‚úÖ –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç** - –¥–æ 3.54x –±—ã—Å—Ç—Ä–µ–µ
4. **‚úÖ 100% –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** - –ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

## üîß –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Vitest –±–µ–Ω—á–º–∞—Ä–∫ –ø–∞–¥–∞–ª —Å –æ—à–∏–±–∫–∞–º–∏
**–°–∏–º–ø—Ç–æ–º—ã:**
```
DataCloneError: () => performance.now() could not be cloned.
Unhandled Rejection/Error
```

**–†–µ—à–µ–Ω–∏–µ:**
- –£–ø—Ä–æ—Å—Ç–∏–ª–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–µ–Ω—á–º–∞—Ä–∫–∞
- –£–±—Ä–∞–ª–∏ —Å–ª–æ–∂–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ summary
- –£–±—Ä–∞–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–¥–∞ –≤ runtime
- –î–æ–±–∞–≤–∏–ª–∏ –ø—Ä–æ—Å—Ç—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù—É–∂–µ–Ω –±—ã–ª –Ω–∞–≥–ª—è–¥–Ω—ã–π —Å–ø–æ—Å–æ–± —É–≤–∏–¥–µ—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç
**–†–µ—à–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞–ª–∏ `simple_performance_test.ts` —Å:
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É
- ‚úÖ –ö—Ä–∞—Å–∏–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤—ã–≤–æ–¥–∞
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –∞–Ω–∞–ª–∏–∑–æ–º

---

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏

| –†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö | –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏—Ä–æ—Å—Ç | –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç | –•—É–¥—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|---------------|-----------------|------------------|------------------|
| **1,000** | **1.47x** | 2.98x (baseline) | 0.69x (array) |
| **10,000** | **2.68x** | 3.45x (baseline) | 1.61x (evaluation) |
| **100,000** | **2.44x** | 3.54x (bitwise) | 1.49x (evaluation) |

### üèÜ –õ—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø—Ä–æ—Å–æ–≤

1. **–ë–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏**: –î–æ **3.54x** –±—ã—Å—Ç—Ä–µ–µ
2. **–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã**: –î–æ **3.45x** –±—ã—Å—Ç—Ä–µ–µ
3. **–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–∞—Å—Å–∏–≤–∞–º–∏**: –î–æ **2.49x** –±—ã—Å—Ç—Ä–µ–µ
4. **Regex –æ–ø–µ—Ä–∞—Ü–∏–∏**: –î–æ **1.61x** –±—ã—Å—Ç—Ä–µ–µ

---

## üõ†Ô∏è –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### 1. –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
# –ë–∞–∑–æ–≤—ã–π —Ç–µ—Å—Ç (1000 –∑–∞–ø–∏—Å–µ–π)
bun src/benchmark/simple_performance_test.ts

# –¢–µ—Å—Ç —Å –±–æ–ª—å—à–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
BENCH_DATA_SIZE=100000 bun src/benchmark/simple_performance_test.ts
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- ‚úÖ Warmup –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ JIT
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –∑–∞–ø—Ä–æ—Å—É
- ‚úÖ –ö—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π vitest –±–µ–Ω—á–º–∞—Ä–∫
```bash
bun vitest bench src/benchmark/build_query.bench.ts --run
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å vitest —ç–∫–æ—Å–∏—Å—Ç–µ–º–æ–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

---

## üìã –¢–µ—Å—Ç–∏—Ä—É–µ–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### 1. BASELINE (–ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–π –∑–∞–ø—Ä–æ—Å)
```json
{
  "name": "test",
  "age": {"$gt": 30},
  "tags": {"$in": ["a","b","c"]},
  "nested": {"value": {"$ne": null}},
  "$or": [
    {"status": "active"},
    {"score": {"$gte": 100}}
  ]
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ 3.45x –±—ã—Å—Ç—Ä–µ–µ

### 2. ARRAY (–û–ø–µ—Ä–∞—Ü–∏–∏ —Å –º–∞—Å—Å–∏–≤–∞–º–∏)
```json
{
  "items": {"$size": 3},
  "values": {"$all": [10,20]},
  "scores": {"$elemMatch": {"$gte": 95}}
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ 2.49x –±—ã—Å—Ç—Ä–µ–µ

### 3. BITWISE (–ë–∏—Ç–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)
```json
{
  "flags": {"$bitsAllSet": 5},
  "mask": {"$bitsAnySet": [1,3]},
  "status": {"$bitsAllClear": 2}
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ 3.54x –±—ã—Å—Ç—Ä–µ–µ

### 4. EVALUATION (Regex –∏ –º–æ–¥—É–ª—å)
```json
{
  "counter": {"$mod": [4,1]},
  "name": {"$regex": "^test", "$options": "i"}
}
```
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î–æ 1.61x –±—ã—Å—Ç—Ä–µ–µ

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

#### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –¥–ª—è:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–∏—Ä–æ—Å—Ç–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

#### –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ vitest –±–µ–Ω—á–º–∞—Ä–∫ –¥–ª—è:
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ CI/CD
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –°—Ä–∞–≤–Ω–µ–Ω–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —Ä–µ—à–µ–Ω–∏—è–º–∏

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
bun src/benchmark/simple_performance_test.ts

# –¢–µ—Å—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
BENCH_DATA_SIZE=1000 bun src/benchmark/simple_performance_test.ts
BENCH_DATA_SIZE=10000 bun src/benchmark/simple_performance_test.ts
BENCH_DATA_SIZE=100000 bun src/benchmark/simple_performance_test.ts

# Vitest –±–µ–Ω—á–º–∞—Ä–∫ (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)
bun vitest bench src/benchmark/build_query.bench.ts --run
```

---

## üìä –í—ã–≤–æ–¥—ã

### ‚úÖ –ß—Ç–æ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ:

1. **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–µ–Ω—á–º–∞—Ä–∫** - —Ç–µ–ø–µ—Ä—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
2. **–°–æ–∑–¥–∞–Ω –ø—Ä–æ—Å—Ç–æ–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç** - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏—Ä–æ—Å—Ç** - compiled query –≤ —Å—Ä–µ–¥–Ω–µ–º –≤ 2.4x –±—ã—Å—Ç—Ä–µ–µ
4. **100% —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–¥–µ–Ω—Ç–∏—á–Ω—ã –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏

### üöÄ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:

- **–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏** –º–æ–≥—É—Ç –ª–µ–≥–∫–æ –∏–∑–º–µ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–≤–æ–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ö–æ–º–∞–Ω–¥–∞** –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –æ –≤—ã–±–æ—Ä–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏** –ø–æ–ª—É—á–∞—é—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üéâ –ò—Ç–æ–≥:

**Compiled Query - —ç—Ç–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞, –∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã –∑–∞–ø—Ä–æ—Å–æ–≤ collection-store!**

---

*–û—Ç—á–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.*